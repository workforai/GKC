# Copyright (c) Facebook, Inc. and its affiliates.
import os

from detectron2.data import DatasetCatalog, MetadataCatalog
from detectron2.data.datasets import load_sem_seg
from torch.functional import split

# VSPW_CATEGORIES = [
PC_CATEGORIES = [
    {'id': 0, 'name': 'other', 'ori_id': 0},
    {'id': 1, 'name': 'aeroplane', 'ori_id': 2},
    {'id': 2, 'name': 'bag', 'ori_id': 9},
    {'id': 3, 'name': 'bed', 'ori_id': 18},
    {'id': 4, 'name': 'bedclothes', 'ori_id': 19},
    {'id': 5, 'name': 'bench', 'ori_id': 22},
    {'id': 6, 'name': 'bicycle', 'ori_id': 23},
    {'id': 7, 'name': 'bird', 'ori_id': 25},
    {'id': 8, 'name': 'boat', 'ori_id': 31},
    {'id': 9, 'name': 'book', 'ori_id': 33},
    {'id': 10, 'name': 'bottle', 'ori_id': 34},
    {'id': 11, 'name': 'building', 'ori_id': 44},
    {'id': 12, 'name': 'bus', 'ori_id': 45},
    {'id': 13, 'name': 'cabinet', 'ori_id': 46},
    {'id': 14, 'name': 'car', 'ori_id': 59},
    {'id': 15, 'name': 'cat', 'ori_id': 65},
    {'id': 16, 'name': 'ceiling', 'ori_id': 68},
    {'id': 17, 'name': 'chair', 'ori_id': 72},
    {'id': 18, 'name': 'cloth', 'ori_id': 80},
    {'id': 19, 'name': 'computer', 'ori_id': 85},
    {'id': 20, 'name': 'cow', 'ori_id': 98},
    {'id': 21, 'name': 'cup', 'ori_id': 104},
    {'id': 22, 'name': 'curtain', 'ori_id': 105},
    {'id': 23, 'name': 'dog', 'ori_id': 113},
    {'id': 24, 'name': 'door', 'ori_id': 115},
    {'id': 25, 'name': 'fence', 'ori_id': 144},
    {'id': 26, 'name': 'floor', 'ori_id': 158},
    {'id': 27, 'name': 'flower', 'ori_id': 159},
    {'id': 28, 'name': 'food', 'ori_id': 162},
    {'id': 29, 'name': 'grass', 'ori_id': 187},
    {'id': 30, 'name': 'ground', 'ori_id': 189},
    {'id': 31, 'name': 'horse', 'ori_id': 207},
    {'id': 32, 'name': 'keyboard', 'ori_id': 220},
    {'id': 33, 'name': 'light', 'ori_id': 232},
    {'id': 34, 'name': 'motorbike', 'ori_id': 258},
    {'id': 35, 'name': 'mountain', 'ori_id': 259},
    {'id': 36, 'name': 'mouse', 'ori_id': 260},
    {'id': 37, 'name': 'person', 'ori_id': 284},
    {'id': 38, 'name': 'plate', 'ori_id': 295},
    {'id': 39, 'name': 'platform', 'ori_id': 296},
    {'id': 40, 'name': 'pottedplant', 'ori_id': 308},
    {'id': 41, 'name': 'road', 'ori_id': 324},
    {'id': 42, 'name': 'rock', 'ori_id': 326},
    {'id': 43, 'name': 'sheep', 'ori_id': 347},
    {'id': 44, 'name': 'shelves', 'ori_id': 349},
    {'id': 45, 'name': 'sidewalk', 'ori_id': 354},
    {'id': 46, 'name': 'sign', 'ori_id': 355},
    {'id': 47, 'name': 'sky', 'ori_id': 360},
    {'id': 48, 'name': 'snow', 'ori_id': 366},
    {'id': 49, 'name': 'sofa', 'ori_id': 368},
    {'id': 50, 'name': 'table', 'ori_id': 397},
    {'id': 51, 'name': 'track', 'ori_id': 415},
    {'id': 52, 'name': 'train', 'ori_id': 416},
    {'id': 53, 'name': 'tree', 'ori_id': 420},
    {'id': 54, 'name': 'truck', 'ori_id': 424},
    {'id': 55, 'name': 'tvmonitor', 'ori_id': 427},
    {'id': 56, 'name': 'wall', 'ori_id': 440},
    {'id': 57, 'name': 'water', 'ori_id': 445},
    {'id': 58, 'name': 'window', 'ori_id': 454},
    {'id': 59, 'name': 'wood', 'ori_id': 458}
]

PC_FULL_CATEGORIES = [
    {'id': 1, 'name': 'accordion'},
    {'id': 2, 'name': 'aeroplane'},
    {'id': 3, 'name': 'air conditioner'},
    {'id': 4, 'name': 'antenna'},
    {'id': 5, 'name': 'artillery'},
    {'id': 6, 'name': 'ashtray'},
    {'id': 7, 'name': 'atrium'},
    {'id': 8, 'name': 'baby carriage'},
    {'id': 9, 'name': 'bag'},
    {'id': 10, 'name': 'ball'},
    {'id': 11, 'name': 'balloon'},
    {'id': 12, 'name': 'bamboo weaving'},
    {'id': 13, 'name': 'barrel'},
    {'id': 14, 'name': 'baseball bat'},
    {'id': 15, 'name': 'basket'},
    {'id': 16, 'name': 'basketball backboard'},
    {'id': 17, 'name': 'bathtub'},
    {'id': 18, 'name': 'bed'},
    {'id': 19, 'name': 'bedclothes'},
    {'id': 20, 'name': 'beer'},
    {'id': 21, 'name': 'bell'},
    {'id': 22, 'name': 'bench'},
    {'id': 23, 'name': 'bicycle'},
    {'id': 24, 'name': 'binoculars'},
    {'id': 25, 'name': 'bird'},
    {'id': 26, 'name': 'bird cage'},
    {'id': 27, 'name': 'bird feeder'},
    {'id': 28, 'name': 'bird nest'},
    {'id': 29, 'name': 'blackboard'},
    {'id': 30, 'name': 'board'},
    {'id': 31, 'name': 'boat'},
    {'id': 32, 'name': 'bone'},
    {'id': 33, 'name': 'book'},
    {'id': 34, 'name': 'bottle'},
    {'id': 35, 'name': 'bottle opener'},
    {'id': 36, 'name': 'bowl'},
    {'id': 37, 'name': 'box'},
    {'id': 38, 'name': 'bracelet'},
    {'id': 39, 'name': 'brick'},
    {'id': 40, 'name': 'bridge'},
    {'id': 41, 'name': 'broom'},
    {'id': 42, 'name': 'brush'},
    {'id': 43, 'name': 'bucket'},
    {'id': 44, 'name': 'building'},
    {'id': 45, 'name': 'bus'},
    {'id': 46, 'name': 'cabinet'},
    {'id': 47, 'name': 'cabinet door'},
    {'id': 48, 'name': 'cage'},
    {'id': 49, 'name': 'cake'},
    {'id': 50, 'name': 'calculator'},
    {'id': 51, 'name': 'calendar'},
    {'id': 52, 'name': 'camel'},
    {'id': 53, 'name': 'camera'},
    {'id': 54, 'name': 'camera lens'},
    {'id': 55, 'name': 'can'},
    {'id': 56, 'name': 'candle'},
    {'id': 57, 'name': 'candle holder'},
    {'id': 58, 'name': 'cap'},
    {'id': 59, 'name': 'car'},
    {'id': 60, 'name': 'card'},
    {'id': 61, 'name': 'cart'},
    {'id': 62, 'name': 'case'},
    {'id': 63, 'name': 'casette recorder'},
    {'id': 64, 'name': 'cash register'},
    {'id': 65, 'name': 'cat'},
    {'id': 66, 'name': 'cd'},
    {'id': 67, 'name': 'cd player'},
    {'id': 68, 'name': 'ceiling'},
    {'id': 69, 'name': 'cell phone'},
    {'id': 70, 'name': 'cello'},
    {'id': 71, 'name': 'chain'},
    {'id': 72, 'name': 'chair'},
    {'id': 73, 'name': 'chessboard'},
    {'id': 74, 'name': 'chicken'},
    {'id': 75, 'name': 'chopstick'},
    {'id': 76, 'name': 'clip'},
    {'id': 77, 'name': 'clippers'},
    {'id': 78, 'name': 'clock'},
    {'id': 79, 'name': 'closet'},
    {'id': 80, 'name': 'cloth'},
    {'id': 81, 'name': 'clothes tree'},
    {'id': 82, 'name': 'coffee'},
    {'id': 83, 'name': 'coffee machine'},
    {'id': 84, 'name': 'comb'},
    {'id': 85, 'name': 'computer'},
    {'id': 86, 'name': 'concrete'},
    {'id': 87, 'name': 'cone'},
    {'id': 88, 'name': 'container'},
    {'id': 89, 'name': 'control booth'},
    {'id': 90, 'name': 'controller'},
    {'id': 91, 'name': 'cooker'},
    {'id': 92, 'name': 'copying machine'},
    {'id': 93, 'name': 'coral'},
    {'id': 94, 'name': 'cork'},
    {'id': 95, 'name': 'corkscrew'},
    {'id': 96, 'name': 'counter'},
    {'id': 97, 'name': 'court'},
    {'id': 98, 'name': 'cow'},
    {'id': 99, 'name': 'crabstick'},
    {'id': 100, 'name': 'crane'},
    {'id': 101, 'name': 'crate'},
    {'id': 102, 'name': 'cross'},
    {'id': 103, 'name': 'crutch'},
    {'id': 104, 'name': 'cup'},
    {'id': 105, 'name': 'curtain'},
    {'id': 106, 'name': 'cushion'},
    {'id': 107, 'name': 'cutting board'},
    {'id': 108, 'name': 'dais'},
    {'id': 109, 'name': 'disc'},
    {'id': 110, 'name': 'disc case'},
    {'id': 111, 'name': 'dishwasher'},
    {'id': 112, 'name': 'dock'},
    {'id': 113, 'name': 'dog'},
    {'id': 114, 'name': 'dolphin'},
    {'id': 115, 'name': 'door'},
    {'id': 116, 'name': 'drainer'},
    {'id': 117, 'name': 'dray'},
    {'id': 118, 'name': 'drink dispenser'},
    {'id': 119, 'name': 'drinking machine'},
    {'id': 120, 'name': 'drop'},
    {'id': 121, 'name': 'drug'},
    {'id': 122, 'name': 'drum'},
    {'id': 123, 'name': 'drum kit'},
    {'id': 124, 'name': 'duck'},
    {'id': 125, 'name': 'dumbbell'},
    {'id': 126, 'name': 'earphone'},
    {'id': 127, 'name': 'earrings'},
    {'id': 128, 'name': 'egg'},
    {'id': 129, 'name': 'electric fan'},
    {'id': 130, 'name': 'electric iron'},
    {'id': 131, 'name': 'electric pot'},
    {'id': 132, 'name': 'electric saw'},
    {'id': 133, 'name': 'electronic keyboard'},
    {'id': 134, 'name': 'engine'},
    {'id': 135, 'name': 'envelope'},
    {'id': 136, 'name': 'equipment'},
    {'id': 137, 'name': 'escalator'},
    {'id': 138, 'name': 'exhibition booth'},
    {'id': 139, 'name': 'extinguisher'},
    {'id': 140, 'name': 'eyeglass'},
    {'id': 141, 'name': 'fan'},
    {'id': 142, 'name': 'faucet'},
    {'id': 143, 'name': 'fax machine'},
    {'id': 144, 'name': 'fence'},
    {'id': 145, 'name': 'ferris wheel'},
    {'id': 146, 'name': 'fire extinguisher'},
    {'id': 147, 'name': 'fire hydrant'},
    {'id': 148, 'name': 'fire place'},
    {'id': 149, 'name': 'fish'},
    {'id': 150, 'name': 'fish tank'},
    {'id': 151, 'name': 'fishbowl'},
    {'id': 152, 'name': 'fishing net'},
    {'id': 153, 'name': 'fishing pole'},
    {'id': 154, 'name': 'flag'},
    {'id': 155, 'name': 'flagstaff'},
    {'id': 156, 'name': 'flame'},
    {'id': 157, 'name': 'flashlight'},
    {'id': 158, 'name': 'floor'},
    {'id': 159, 'name': 'flower'},
    {'id': 160, 'name': 'fly'},
    {'id': 161, 'name': 'foam'},
    {'id': 162, 'name': 'food'},
    {'id': 163, 'name': 'footbridge'},
    {'id': 164, 'name': 'forceps'},
    {'id': 165, 'name': 'fork'},
    {'id': 166, 'name': 'forklift'},
    {'id': 167, 'name': 'fountain'},
    {'id': 168, 'name': 'fox'},
    {'id': 169, 'name': 'frame'},
    {'id': 170, 'name': 'fridge'},
    {'id': 171, 'name': 'frog'},
    {'id': 172, 'name': 'fruit'},
    {'id': 173, 'name': 'funnel'},
    {'id': 174, 'name': 'furnace'},
    {'id': 175, 'name': 'game controller'},
    {'id': 176, 'name': 'game machine'},
    {'id': 177, 'name': 'gas cylinder'},
    {'id': 178, 'name': 'gas hood'},
    {'id': 179, 'name': 'gas stove'},
    {'id': 180, 'name': 'gift box'},
    {'id': 181, 'name': 'glass'},
    {'id': 182, 'name': 'glass marble'},
    {'id': 183, 'name': 'globe'},
    {'id': 184, 'name': 'glove'},
    {'id': 185, 'name': 'goal'},
    {'id': 186, 'name': 'grandstand'},
    {'id': 187, 'name': 'grass'},
    {'id': 188, 'name': 'gravestone'},
    {'id': 189, 'name': 'ground'},
    {'id': 190, 'name': 'guardrail'},
    {'id': 191, 'name': 'guitar'},
    {'id': 192, 'name': 'gun'},
    {'id': 193, 'name': 'hammer'},
    {'id': 194, 'name': 'hand cart'},
    {'id': 195, 'name': 'handle'},
    {'id': 196, 'name': 'handrail'},
    {'id': 197, 'name': 'hanger'},
    {'id': 198, 'name': 'hard disk drive'},
    {'id': 199, 'name': 'hat'},
    {'id': 200, 'name': 'hay'},
    {'id': 201, 'name': 'headphone'},
    {'id': 202, 'name': 'heater'},
    {'id': 203, 'name': 'helicopter'},
    {'id': 204, 'name': 'helmet'},
    {'id': 205, 'name': 'holder'},
    {'id': 206, 'name': 'hook'},
    {'id': 207, 'name': 'horse'},
    {'id': 208, 'name': 'horse-drawn carriage'},
    {'id': 209, 'name': 'hot-air balloon'},
    {'id': 210, 'name': 'hydrovalve'},
    {'id': 211, 'name': 'ice'},
    {'id': 212, 'name': 'inflator pump'},
    {'id': 213, 'name': 'ipod'},
    {'id': 214, 'name': 'iron'},
    {'id': 215, 'name': 'ironing board'},
    {'id': 216, 'name': 'jar'},
    {'id': 217, 'name': 'kart'},
    {'id': 218, 'name': 'kettle'},
    {'id': 219, 'name': 'key'},
    {'id': 220, 'name': 'keyboard'},
    {'id': 221, 'name': 'kitchen range'},
    {'id': 222, 'name': 'kite'},
    {'id': 223, 'name': 'knife'},
    {'id': 224, 'name': 'knife block'},
    {'id': 225, 'name': 'ladder'},
    {'id': 226, 'name': 'ladder truck'},
    {'id': 227, 'name': 'ladle'},
    {'id': 228, 'name': 'laptop'},
    {'id': 229, 'name': 'leaves'},
    {'id': 230, 'name': 'lid'},
    {'id': 231, 'name': 'life buoy'},
    {'id': 232, 'name': 'light'},
    {'id': 233, 'name': 'light bulb'},
    {'id': 234, 'name': 'lighter'},
    {'id': 235, 'name': 'line'},
    {'id': 236, 'name': 'lion'},
    {'id': 237, 'name': 'lobster'},
    {'id': 238, 'name': 'lock'},
    {'id': 239, 'name': 'machine'},
    {'id': 240, 'name': 'mailbox'},
    {'id': 241, 'name': 'mannequin'},
    {'id': 242, 'name': 'map'},
    {'id': 243, 'name': 'mask'},
    {'id': 244, 'name': 'mat'},
    {'id': 245, 'name': 'match book'},
    {'id': 246, 'name': 'mattress'},
    {'id': 247, 'name': 'menu'},
    {'id': 248, 'name': 'metal'},
    {'id': 249, 'name': 'meter box'},
    {'id': 250, 'name': 'microphone'},
    {'id': 251, 'name': 'microwave'},
    {'id': 252, 'name': 'mirror'},
    {'id': 253, 'name': 'missile'},
    {'id': 254, 'name': 'model'},
    {'id': 255, 'name': 'money'},
    {'id': 256, 'name': 'monkey'},
    {'id': 257, 'name': 'mop'},
    {'id': 258, 'name': 'motorbike'},
    {'id': 259, 'name': 'mountain'},
    {'id': 260, 'name': 'mouse'},
    {'id': 261, 'name': 'mouse pad'},
    {'id': 262, 'name': 'musical instrument'},
    {'id': 263, 'name': 'napkin'},
    {'id': 264, 'name': 'net'},
    {'id': 265, 'name': 'newspaper'},
    {'id': 266, 'name': 'oar'},
    {'id': 267, 'name': 'ornament'},
    {'id': 268, 'name': 'outlet'},
    {'id': 269, 'name': 'oven'},
    {'id': 270, 'name': 'oxygen bottle'},
    {'id': 271, 'name': 'pack'},
    {'id': 272, 'name': 'pan'},
    {'id': 273, 'name': 'paper'},
    {'id': 274, 'name': 'paper box'},
    {'id': 275, 'name': 'paper cutter'},
    {'id': 276, 'name': 'parachute'},
    {'id': 277, 'name': 'parasol'},
    {'id': 278, 'name': 'parterre'},
    {'id': 279, 'name': 'patio'},
    {'id': 280, 'name': 'pelage'},
    {'id': 281, 'name': 'pen'},
    {'id': 282, 'name': 'pen container'},
    {'id': 283, 'name': 'pencil'},
    {'id': 284, 'name': 'person'},
    {'id': 285, 'name': 'photo'},
    {'id': 286, 'name': 'piano'},
    {'id': 287, 'name': 'picture'},
    {'id': 288, 'name': 'pig'},
    {'id': 289, 'name': 'pillar'},
    {'id': 290, 'name': 'pillow'},
    {'id': 291, 'name': 'pipe'},
    {'id': 292, 'name': 'pitcher'},
    {'id': 293, 'name': 'plant'},
    {'id': 294, 'name': 'plastic'},
    {'id': 295, 'name': 'plate'},
    {'id': 296, 'name': 'platform'},
    {'id': 297, 'name': 'player'},
    {'id': 298, 'name': 'playground'},
    {'id': 299, 'name': 'pliers'},
    {'id': 300, 'name': 'plume'},
    {'id': 301, 'name': 'poker'},
    {'id': 302, 'name': 'poker chip'},
    {'id': 303, 'name': 'pole'},
    {'id': 304, 'name': 'pool table'},
    {'id': 305, 'name': 'postcard'},
    {'id': 306, 'name': 'poster'},
    {'id': 307, 'name': 'pot'},
    {'id': 308, 'name': 'pottedplant'},
    {'id': 309, 'name': 'printer'},
    {'id': 310, 'name': 'projector'},
    {'id': 311, 'name': 'pumpkin'},
    {'id': 312, 'name': 'rabbit'},
    {'id': 313, 'name': 'racket'},
    {'id': 314, 'name': 'radiator'},
    {'id': 315, 'name': 'radio'},
    {'id': 316, 'name': 'rail'},
    {'id': 317, 'name': 'rake'},
    {'id': 318, 'name': 'ramp'},
    {'id': 319, 'name': 'range hood'},
    {'id': 320, 'name': 'receiver'},
    {'id': 321, 'name': 'recorder'},
    {'id': 322, 'name': 'recreational machines'},
    {'id': 323, 'name': 'remote control'},
    {'id': 324, 'name': 'road'},
    {'id': 325, 'name': 'robot'},
    {'id': 326, 'name': 'rock'},
    {'id': 327, 'name': 'rocket'},
    {'id': 328, 'name': 'rocking horse'},
    {'id': 329, 'name': 'rope'},
    {'id': 330, 'name': 'rug'},
    {'id': 331, 'name': 'ruler'},
    {'id': 332, 'name': 'runway'},
    {'id': 333, 'name': 'saddle'},
    {'id': 334, 'name': 'sand'},
    {'id': 335, 'name': 'saw'},
    {'id': 336, 'name': 'scale'},
    {'id': 337, 'name': 'scanner'},
    {'id': 338, 'name': 'scissors'},
    {'id': 339, 'name': 'scoop'},
    {'id': 340, 'name': 'screen'},
    {'id': 341, 'name': 'screwdriver'},
    {'id': 342, 'name': 'sculpture'},
    {'id': 343, 'name': 'scythe'},
    {'id': 344, 'name': 'sewer'},
    {'id': 345, 'name': 'sewing machine'},
    {'id': 346, 'name': 'shed'},
    {'id': 347, 'name': 'sheep'},
    {'id': 348, 'name': 'shell'},
    {'id': 349, 'name': 'shelves'},
    {'id': 350, 'name': 'shoe'},
    {'id': 351, 'name': 'shopping cart'},
    {'id': 352, 'name': 'shovel'},
    {'id': 353, 'name': 'sidecar'},
    {'id': 354, 'name': 'sidewalk'},
    {'id': 355, 'name': 'sign'},
    {'id': 356, 'name': 'signal light'},
    {'id': 357, 'name': 'sink'},
    {'id': 358, 'name': 'skateboard'},
    {'id': 359, 'name': 'ski'},
    {'id': 360, 'name': 'sky'},
    {'id': 361, 'name': 'sled'},
    {'id': 362, 'name': 'slippers'},
    {'id': 363, 'name': 'smoke'},
    {'id': 364, 'name': 'snail'},
    {'id': 365, 'name': 'snake'},
    {'id': 366, 'name': 'snow'},
    {'id': 367, 'name': 'snowmobiles'},
    {'id': 368, 'name': 'sofa'},
    {'id': 369, 'name': 'spanner'},
    {'id': 370, 'name': 'spatula'},
    {'id': 371, 'name': 'speaker'},
    {'id': 372, 'name': 'speed bump'},
    {'id': 373, 'name': 'spice container'},
    {'id': 374, 'name': 'spoon'},
    {'id': 375, 'name': 'sprayer'},
    {'id': 376, 'name': 'squirrel'},
    {'id': 377, 'name': 'stage'},
    {'id': 378, 'name': 'stair'},
    {'id': 379, 'name': 'stapler'},
    {'id': 380, 'name': 'stick'},
    {'id': 381, 'name': 'sticky note'},
    {'id': 382, 'name': 'stone'},
    {'id': 383, 'name': 'stool'},
    {'id': 384, 'name': 'stove'},
    {'id': 385, 'name': 'straw'},
    {'id': 386, 'name': 'stretcher'},
    {'id': 387, 'name': 'sun'},
    {'id': 388, 'name': 'sunglass'},
    {'id': 389, 'name': 'sunshade'},
    {'id': 390, 'name': 'surveillance camera'},
    {'id': 391, 'name': 'swan'},
    {'id': 392, 'name': 'sweeper'},
    {'id': 393, 'name': 'swim ring'},
    {'id': 394, 'name': 'swimming pool'},
    {'id': 395, 'name': 'swing'},
    {'id': 396, 'name': 'switch'},
    {'id': 397, 'name': 'table'},
    {'id': 398, 'name': 'tableware'},
    {'id': 399, 'name': 'tank'},
    {'id': 400, 'name': 'tap'},
    {'id': 401, 'name': 'tape'},
    {'id': 402, 'name': 'tarp'},
    {'id': 403, 'name': 'telephone'},
    {'id': 404, 'name': 'telephone booth'},
    {'id': 405, 'name': 'tent'},
    {'id': 406, 'name': 'tire'},
    {'id': 407, 'name': 'toaster'},
    {'id': 408, 'name': 'toilet'},
    {'id': 409, 'name': 'tong'},
    {'id': 410, 'name': 'tool'},
    {'id': 411, 'name': 'toothbrush'},
    {'id': 412, 'name': 'towel'},
    {'id': 413, 'name': 'toy'},
    {'id': 414, 'name': 'toy car'},
    {'id': 415, 'name': 'track'},
    {'id': 416, 'name': 'train'},
    {'id': 417, 'name': 'trampoline'},
    {'id': 418, 'name': 'trash bin'},
    {'id': 419, 'name': 'tray'},
    {'id': 420, 'name': 'tree'},
    {'id': 421, 'name': 'tricycle'},
    {'id': 422, 'name': 'tripod'},
    {'id': 423, 'name': 'trophy'},
    {'id': 424, 'name': 'truck'},
    {'id': 425, 'name': 'tube'},
    {'id': 426, 'name': 'turtle'},
    {'id': 427, 'name': 'tvmonitor'},
    {'id': 428, 'name': 'tweezers'},
    {'id': 429, 'name': 'typewriter'},
    {'id': 430, 'name': 'umbrella'},
    {'id': 431, 'name': 'unknown'},
    {'id': 432, 'name': 'vacuum cleaner'},
    {'id': 433, 'name': 'vending machine'},
    {'id': 434, 'name': 'video camera'},
    {'id': 435, 'name': 'video game console'},
    {'id': 436, 'name': 'video player'},
    {'id': 437, 'name': 'video tape'},
    {'id': 438, 'name': 'violin'},
    {'id': 439, 'name': 'wakeboard'},
    {'id': 440, 'name': 'wall'},
    {'id': 441, 'name': 'wallet'},
    {'id': 442, 'name': 'wardrobe'},
    {'id': 443, 'name': 'washing machine'},
    {'id': 444, 'name': 'watch'},
    {'id': 445, 'name': 'water'},
    {'id': 446, 'name': 'water dispenser'},
    {'id': 447, 'name': 'water pipe'},
    {'id': 448, 'name': 'water skate board'},
    {'id': 449, 'name': 'watermelon'},
    {'id': 450, 'name': 'whale'},
    {'id': 451, 'name': 'wharf'},
    {'id': 452, 'name': 'wheel'},
    {'id': 453, 'name': 'wheelchair'},
    {'id': 454, 'name': 'window'},
    {'id': 455, 'name': 'window blinds'},
    {'id': 456, 'name': 'wineglass'},
    {'id': 457, 'name': 'wire'},
    {'id': 458, 'name': 'wood'},
    {'id': 459, 'name': 'wool'}
]

def _get_pc_meta(full=False):
    if full:
        # Id 0 is reserved for ignore_label, we change ignore_label for 0
        # to 255 in our pre-processing.
        stuff_ids = [k["id"] for k in PC_FULL_CATEGORIES]
        assert len(stuff_ids) == 459, len(stuff_ids)

        # For semantic segmentation, this mapping maps from contiguous stuff id
        # (in [0, 91], used in models) to ids in the dataset (used for processing results)
        stuff_dataset_id_to_contiguous_id = {k: i for i, k in enumerate(stuff_ids)}
        stuff_classes = [k["name"] for k in PC_FULL_CATEGORIES]
    else:
        # Id 0 is reserved for ignore_label, we change ignore_label for 0
        # to 255 in our pre-processing.
        stuff_ids = [k["id"] for k in PC_CATEGORIES[1:]]
        assert len(stuff_ids) == 59, len(stuff_ids)

        # For semantic segmentation, this mapping maps from contiguous stuff id
        # (in [0, 91], used in models) to ids in the dataset (used for processing results)
        stuff_dataset_id_to_contiguous_id = {k: i for i, k in enumerate(stuff_ids)}
        stuff_classes = [k["name"] for k in PC_CATEGORIES[1:]]

    ret = {
        "stuff_dataset_id_to_contiguous_id": stuff_dataset_id_to_contiguous_id,
        "stuff_classes": stuff_classes,
    }
    return ret


def load_sem_seg_pc(split_path, gt_dir, image_dir, gt_ext, image_ext):
    with open(split_path) as f:
        content = f.readlines()
    filename_list = [c.strip() for c in content]

    dataset_dicts = []
    for filename in filename_list:
        record = {}
        record["file_name"] = os.path.join(image_dir, "{}.{}".format(filename, image_ext))
        record["sem_seg_file_name"] = os.path.join(gt_dir, "{}.{}".format(filename, gt_ext))
        dataset_dicts.append(record)

    return dataset_dicts


def register_pc(root):
    # root = os.path.join(root, "pascal_context")

    for name, image_dirname, sem_seg_dirname in [
        ("val", "VOCdevkit/VOC2010/JPEGImages", "VOCdevkit/VOC2010/SegmentationClassContext"),
    ]:
        # split_path = os.path.join(root, "VOCdevkit/VOC2010/ImageSets/SegmentationContext/{}.txt".format(name))
        split_path = os.path.join(root, "VOCdevkit/VOC2010/ImageSets/SegmentationContext/val.txt")
        image_dir = os.path.join(root, image_dirname)
        gt_dir = os.path.join(root, sem_seg_dirname)
        name = f"pc_{name}_sem_seg"
        DatasetCatalog.register(
            name, 
            lambda :load_sem_seg_pc(split_path, gt_dir, image_dir, gt_ext="png", image_ext="jpg")
        )
        MetadataCatalog.get(name).set(
            image_root=image_dir,
            sem_seg_root=gt_dir,
            evaluator_type="sem_seg",
            ignore_label=255,
            **_get_pc_meta(full=False),
        )

def register_pc_full(root):
    # root = os.path.join(root, "pascal_context")

    for name, image_dirname, sem_seg_dirname in [
        ("val", "VOCdevkit/VOC2010/JPEGImages", "VOCdevkit/VOC2010/SegmentationClassContext_459"),
    ]:
        # split_path = os.path.join(root, "VOCdevkit/VOC2010/ImageSets/SegmentationContext/{}.txt".format(name))
        split_path = os.path.join(root, "VOCdevkit/VOC2010/ImageSets/SegmentationContext/val.txt")
        image_dir = os.path.join(root, image_dirname)
        gt_dir = os.path.join(root, sem_seg_dirname)
        name = f"pc_full_{name}_sem_seg"
        DatasetCatalog.register(
            name, 
            lambda :load_sem_seg_pc(split_path, gt_dir, image_dir, gt_ext="png", image_ext="jpg")
        )
        MetadataCatalog.get(name).set(
            image_root=image_dir,
            sem_seg_root=gt_dir,
            evaluator_type="sem_seg",
            ignore_label=65535,
            **_get_pc_meta(full=True),
        )


_root = os.getenv("DETECTRON2_DATASETS", "datasets")
register_pc(_root)
register_pc_full(_root)